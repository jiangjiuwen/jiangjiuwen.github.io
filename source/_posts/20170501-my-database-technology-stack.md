---
title: 我的数据库技术栈
categories: 编程之美
date: 2017-05-01 14:06:21
tags:
  - 数据库
  - 技术栈
keywords: 数据库,技术栈
---

这篇文章实际上是对我的数据库知识的一点总结。

下图是我在手机上用MindNode(强烈推荐Apple产品用户下载使用)画的一张脑图。

<img src="http://7xr526.com1.z0.glb.clouddn.com/database%20technology%20stack/new%20image%20-%202fm40.jpg" class="full-image" title="Database Technology Stack" />

# 什么是数据库

[维基百科](https://zh.wikipedia.org/wiki/%E6%95%B0%E6%8D%AE%E5%BA%93)如是说：

> 数据库指的是以一定方式储存在一起、能为多个用户共享、具有尽可能小的冗余度、与应用程序彼此独立的数据集合。

通俗的理解就是数据库是一个用于存储数据的仓库，用户可以通过增删改查等操作对仓库中的数据进行管理。
<!-- more -->
# 数据库分类

目前数据库主要分为关系型数据库和非关系型数据库两大类。

## 关系型数据库
关系型数据库(RDBMS)是指采用关系模型来组织数据的数据库，其中的关系模式就是指二维表格模型，所以关系型数据库就是由多张二维表格以及表格之间的关联所组成的数据组织。

常见的关系型数据库主要有：MSSQL、MySQL、Oracle。

## 非关系型数据库

非关系型数据库又叫做NoSQL(Not only SQL)，顾名思义，不仅仅是SQL，算得上是对关系型数据库的扩展吧。

常见的非关系型数据库有四大类：键值存储数据库、列存储数据库、文档型数据库、图形数据库。比如比较流行的MongoDB就是一种文档型数据库。

## RDBMS和NoSQL比较

- 非关系型数据库简单易部署，而且基本都是开源软件，而关系型数据库则不易部署且价格昂贵
- 非关系型数据库查询速度更快。因为非关系型数据库的数据通常存储与缓存之中，而关系型数据库将数据存储在硬盘中
- 非关系型数据库数据存储格式多样化，比如键值对形式、文档形式、图片形式等，而关系型数据库只支持基础数据类型
- 非关系型数据库具有较好的扩展性，但是关系型数据库由于有太多的机制限制其扩展性
- 关系型数据库提供SQL语言的支持，但是非关系型数据库不支持
- 关系型数据库支持事务，而非关系型数据库不支持

# 事务

事务是关系型数据库独有的特性，主要包括原子性、一致性、隔离性和持久性，简称ACID。

## 原子性(Atomicity)

原子性是指把一系列数据库操作语句作为一个原子来对待，即一个事务包含一系列操作语句，这些语句要么全部执行成功，要么某句失败后全部操作回滚，不存在部分执行成功，部分执行失败的可能。比如，执行从账户A向账户B转账100块的操作，结果是要么A账户减少100块且B账户增加100块，要么A账户金额不变且B账户金额不变，不存在A账户减少100块，而B账户金额不变的情况。

## 一致性(Consistency)

一致性是指一个事务在开始前和开始后数据库的完整性约束没有改变。即一个事务执行前和执行后数据始终符合之前设置的约束，比如主外键关联、数据检查等始终保持不变。

## 隔离性(Isolation)

隔离性是指多个事务之间是不关联的相互独立的，一个事务在执行过程中不能访问到另一个事务执行过程中的数据。但是完全的隔离是不现实的，除非一次只执行一个事务，但是这样做的效率是不忍直视的。事务之间的相互影响主要有以下三种。

- 脏读。即一个事务读取了另一个事务还未提交的数据，而这个数据有可能被回滚
- 不可重复度。即一个事务范围内两次相同的查询却返回了不同的数据，比如，事务第一次查询之后另一个事务在数据库中对该数据进行了修改，导致事务第二次查询的结果和第一次查询的结果不一致。
- 幻读。即一个事务A在更新表中数据的时候，另一个事务Bi新增了一条符合事务A修改条件的新数据，导致最后发现还有事务A没有更新的数据，就像幻觉一样。

所以为了消除事务之间的相互影响，可以通过对数据库加锁的方式来隔离不同的事务，但是这样会导致查询效率降低。

## 持久性(Durability)

持久性是指事务对数据进行的改变会持续保留在数据库中，不会随着事务的结束或关闭数据库等操作而回滚。

# 范式

为了建立冗余较小，结构合理的数据库，设计数据库时必须遵循一定的规范，在关系型数据库中，这种规则就叫做范式。在实际开发中使用的范式主要有三种。

## 第一范式(NF1)

第一范式确保每列保持原子性。第一范式是数据库设计最基本的范式，如果表中所有字段都是不可再分解的原子值，就说明该数据库设计符合第一范式。例如，根据项目实际情况，可将地址拆分为省份、城市、区域、详细地址等字段，这样对地址中的某一部分操作就变得非常方便。

## 第二范式(NF2)

第二范式确保表中的每列都和主键有关。即一张表只能存储一类数据，而不能将多种数据存在一张表中。比如订单信息和商品信息属于两类信息，应该分开建表存储，并通过关联表进行关联，而不是将订单信息和商品信息存储在一张表中。

## 第三范式(NF3)

第三范式确保每列都和主键直接关联，而不是间接关联。第三范式和第二范式有点相似，不同之处在于将不同类信息通过主外键关系进行关联。

# 语言

## 数据定义语言(DDL)

数据定义语言(Data Definition Language)用于对数据库或数据库表进行操作，比如`CREATE`、`ALTER`、`DROP`

## 数据操作语言(DML)

数据操作语言(Data Manipulation Language)用于对数据进行操作，比如`SELECT`、`INSERT INTO`、`UPDATE`、`DELETE`

## 数据控制语言(DCL)

数据控制语言(Data Control Language)用于设置或更改数据库用户或角色权限，比如`GRANT`、`DENY`、`REVOKE`

## 事务控制语言(TCL)

事务控制语言(Transact Control Language)用于控制事务的语言，比如`SAVEPOINT`、`ROLLBACK`、`COMMIT`

# 对象

## 索引

索引就是加快检索表中数据的方法。其原理类似于书籍的目录，即不需要扫描整个数据库都能快速找到所需的数据。

## 视图

视图是虚表，是从一个或多个基本表中导出的表，视图对应的数据不进行实际存储，数据库只存储视图的定义，在对视图的数据进行操作时，系统根据视图的定义去操作与视图相关联的基本表。

## 触发器

触发器是一种特殊的存储过程。一般的存储过程是直接调用，而触发器主要是通过事件，比如增删改，进行触发而被执行，其在表中数据发生变化时自动强制执行。

常见的触发器有两种：AFTER(FOR) INSTEAD OF，用于INSERT、UPDATE、DELETE事件。

AFTER(FOR)表示执行代码后执行触发器

INSTEAD OF表示执行代码前，用已经写好的触发器代替你的操作。

> 以上很多都只解释了定义，没有解释原理和举例，后续再写吧，毕竟这篇文章只是用来解释我画的那张脑图。